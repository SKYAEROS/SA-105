<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Services Benj.RLT</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <header class="navbar">
        <div class="logo">
            <a href="index.html" style="display: flex; align-items: center;">
                <img src="img/logo.png" alt="Logo">
            </a>
        </div>

        <nav>
            <ul class="nav-links">

                <li><a href="portfolio.html">Portfolio</a></li>

                <li><a href="services.html">Services</a></li>

                <li><a href="contact.html">Contact</a></li>
                <li><a href="panier.html">Panier</a></li>
            </ul>
        </nav>
        <div class="burger-menu" id="burgerMenu">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </header>
    <div class="main-wrapper contact-wrapper services-wrapper" style="align-items: flex-start; padding-top: 150px;">

        <div class="services-container">
            <h1 class="page-title" style="text-align: center; margin-bottom: 60px;">Mes Prestations</h1>

            <div class="services-grid">

                <!-- 1. Tournage -->
                <div class="service-card" data-service="tournage">
                    <div class="card-image tournage-img"></div>
                    <div class="card-content">
                        <h2>Tournage</h2>
                        <p class="service-desc">Captation 4K, Éclairage, Prise de son. L'expertise technique sur le
                            terrain.</p>
                        <button class="add-btn" onclick="openModal('tournage')">Configurer le devis</button>
                    </div>
                </div>

                <!-- 2. Montage -->
                <div class="service-card" data-service="montage">
                    <div class="card-image montage-img"></div>
                    <div class="card-content">
                        <h2>Montage</h2>
                        <p class="service-desc">Derushage, Colorimétrie, Sound Design. Sublimez vos images.</p>
                        <button class="add-btn" onclick="openModal('montage')">Configurer le devis</button>
                    </div>
                </div>

                <!-- 3. Projet A à Z -->
                <div class="service-card" data-service="full">
                    <div class="card-image full-img"></div>
                    <div class="card-content">
                        <h2>Projet A à Z</h2>
                        <p class="service-desc">De la conception à la diffusion. Scénario, Tournage, Post-production.
                        </p>
                        <button class="add-btn" onclick="openModal('full')">Configurer le devis</button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Booking Modal -->
    <div id="bookingModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 id="modalTitle">Configurer votre prestation</h2>

            <form id="bookingForm" onsubmit="addToCart(event)">
                <input type="hidden" id="serviceType" name="serviceType">

                <!-- Dynamic Fields Container -->
                <div id="dynamicFields">
                    <!-- Fields injected by JS -->
                </div>

                <!-- Common Field -->
                <div class="input-group">
                    <textarea name="notes" placeholder="Détails supplémentaires (Optionnel)" rows="3"></textarea>
                </div>

                <button type="submit" class="send-btn" style="width: 100%; justify-content: center;">Ajouter au
                    Panier</button>
            </form>
        </div>
    </div>

    <script>
        const modal = document.getElementById("bookingModal");
        const dynamicFields = document.getElementById("dynamicFields");
        const modalTitle = document.getElementById("modalTitle");
        const serviceTypeInput = document.getElementById("serviceType");

        const serviceConfig = {
            tournage: {
                title: "Réservation Tournage",
                fields: `
                    <div class="input-group">
                        <label style="position:static; color:#ccc; margin-bottom:5px; display:block;">Type de Caméra</label>
                        <select name="camera" id="camera" style="width:100%; padding:10px; background:#222; color:#fff; border:1px solid #444; border-radius:5px;">
                            <option value="fx3" data-price="200">Sony FX3 (Cinéma) +200€</option>
                            <option value="hybrid" data-price="100">Hybride (Standard) +100€</option>
                            <option value="drone" data-price="300">Drone FPV +300€</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label style="position:static; color:#ccc; margin-bottom:5px; display:block;">Durée estimée</label>
                        <select name="duration" id="duration" onchange="toggleDaysField(this)" style="width:100%; padding:10px; background:#222; color:#fff; border:1px solid #444; border-radius:5px;">
                            <option value="half_day" data-price="400">Demi-journée (4h) +400€</option>
                            <option value="full_day" data-price="700">Journée complète (8h) +700€</option>
                            <option value="multi" data-daily-rate="600">Plusieurs jours (Tarif journalier)</option>
                        </select>
                         <div id="days-container" style="display:none; margin-top:10px;">
                            <label style="position:static; color:#ccc; margin-bottom:5px; display:block;">Nombre de jours</label>
                            <input type="number" name="nb_days" id="nb_days" value="2" min="2" max="10" style="width:100%; padding:10px; background:#222; color:#fff; border:1px solid #444; border-radius:5px;">
                        </div>
                    </div>
                `
            },
            montage: {
                title: "Devis Montage",
                fields: `
                   <div class="input-group">
                        <label style="position:static; color:#ccc; margin-bottom:5px; display:block;">Volume de Rushs</label>
                        <select name="rush_volume" id="rush_volume" style="width:100%; padding:10px; background:#222; color:#fff; border:1px solid #444; border-radius:5px;">
                            <option value="low" data-price="0">< 10 Go (Inclus)</option>
                            <option value="med" data-price="50">10 Go - 50 Go +50€</option>
                            <option value="high" data-price="100">> 50 Go +100€</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label style="position:static; color:#ccc; margin-bottom:5px; display:block;">Style</label>
                        <select name="style" id="style" style="width:100%; padding:10px; background:#222; color:#fff; border:1px solid #444; border-radius:5px;">
                            <option value="dynamic" data-price="200">Dynamique / Réseaux Sociaux +200€</option>
                            <option value="cinematic" data-price="300">Cinématique / Docu +300€</option>
                            <option value="corp" data-price="150">Corporate / Interview +150€</option>
                        </select>
                    </div>
                `
            },
            full: {
                title: "Projet A à Z",
                fields: `
                    <div class="input-group">
                        <label style="position:static; color:#ccc; margin-bottom:5px; display:block;">Type de Projet</label>
                        <input type="text" name="project_type" placeholder="Ex: Publicité, Clip, Court-métrage" style="width:100%; padding:10px; background:transparent; border-bottom:1px solid #fff; color:#fff;">
                    </div>
                    <div class="input-group">
                        <label style="position:static; color:#ccc; margin-bottom:5px; display:block;">Budget de départ</label>
                        <select name="budget" id="budget" style="width:100%; padding:10px; background:#222; color:#fff; border:1px solid #444; border-radius:5px;">
                            <option value="small" data-price="500">Pack Small (500€)</option>
                            <option value="med" data-price="1500">Pack Medium (1500€)</option>
                            <option value="large" data-price="3000">Pack Large (3000€)</option>
                        </select>
                    </div>
                `
            }
        };

        function openModal(type) {
            const config = serviceConfig[type];
            modalTitle.textContent = config.title;
            dynamicFields.innerHTML = config.fields;
            serviceTypeInput.value = type;
            modal.style.display = "block";
            // Prevent body scroll
            document.body.style.overflow = "hidden";
        }

        function closeModal() {
            modal.style.display = "none";
            document.body.style.overflow = "auto";
        }

        function toggleDaysField(select) {
            const container = document.getElementById('days-container');
            if (select.value === 'multi') {
                container.style.display = 'block';
            } else {
                container.style.display = 'none';
            }
        }

        function addToCart(e) {
            e.preventDefault();
            // Get form data
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData.entries());

            // --- PRICE CALCULATION LOGIC ---
            let totalPrice = 0;
            const formElements = e.target.elements;

            // Iterate over form elements to find selects with data-price
            for (let element of formElements) {
                if (element.tagName === 'SELECT') {
                    const selectedOption = element.options[element.selectedIndex];

                    // Specific Logic for Multi-Day
                    if (element.name === 'duration' && element.value === 'multi') {
                        const dailyRate = parseFloat(selectedOption.getAttribute('data-daily-rate')) || 0;
                        const daysInput = document.getElementById('nb_days');
                        const days = parseInt(daysInput.value) || 0;
                        totalPrice += dailyRate * days;
                    } else {
                        const price = parseFloat(selectedOption.getAttribute('data-price')) || 0;
                        totalPrice += price;
                    }
                }
            }

            data.totalPrice = totalPrice; // Add calculated price to data object
            // -------------------------------

            // Get existing cart or init
            let cart = JSON.parse(localStorage.getItem('cart') || '[]');
            cart.push(data);
            localStorage.setItem('cart', JSON.stringify(cart));

            alert("Service ajouté au panier ! Montant estimé: " + totalPrice + "€");
            closeModal();
            // Redirect to basket or stay? User said "add to panier"
            // location.href = 'panier.html'; 
        }

        // Close if click outside
        window.onclick = function (event) {
            if (event.target == modal) {
                closeModal();
            }
        }
    </script>
    <footer class="main-footer">
        <div class="footer-content">
            <p>&copy; 2026 Benj.RLT & Luis Rivas - Projet SAE 105</p>
            <span class="separator">|</span>
            <a href="mentions.html" class="legal-link">Mentions Légales</a>
        </div>
    </footer>
    
</body>

</html>